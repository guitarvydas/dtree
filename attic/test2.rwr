% parameter paramA
% parameter paramB
% parameter paramC
% parameter diagramid
% parameter cellid
% parameter parentid

% rewrite example {
Main [a (_semi b)+ c d+]=
  ⎡ ⎨print ‛pre down a=«a» _semi=«_semi» b=«b» c=«c» d=«d»’⎬
    ⎡ paramA=‛«a»’
      ⎡ paramB=‛«b»’
        ⎡ paramC=‛«c»’
          ⎡ ⎨print ‛hello’⎬
            ‛... ⎨print2 ‛middle’ ‛2nd arg’⎬ «a»«_semi»⟪paramB⟫«c»«d»...’ 
          ⎦
        ⎦
      ⎦
    ⎦
  ⎦


  Top [lb stuff* _ Diagrams+ rb] = ‛«Diagrams»⎨maptopl⎬’

  Diagram [lb attr+ _ graphmodel rb] =
    ⎡ diagramid=‛⎨newdiagramid⎬’
      ⎡ parentid =‛⟪diagramid⟫’
        ‛\ndiagram(⟪diagramid⟫).«attr»\n«graphmodel»\n’
      ⎦
    ⎦

  GraphModel [lb stuff+ _gt _root cells+ _eroot rb] = ‛\n«cells»’
  Cell_long [lb attr+ _gt geometry? rb] =
    ⎡ cellid=‛⎨newcellid⎬’
      ⎡ parentid =‛⟪cellid⟫’
        ‛\ncell(⟪cellid⟫).«attr»’
      ⎦
    ⎦
  Cell_short [lb attr+ _slgt] =
    ⎡ cellid=‛⎨newcellid⎬’
      ⎡ parentid =‛⟪cellid⟫’
        ‛\ncell(⟪cellid⟫).«attr»’
      ⎦
    ⎦

  Geometry_long [lb attr+ _gt any+ rb] = ‛’
  Geometry_short [lb attr+ rb] = ‛’

  Attribute_name [name _eq s] = ‛\nname(⟪parentid⟫,«s»).’
  Attribute_id [name _eq mid] = ‛\nref($⟪parentid⟫,@«mid»).’
  Attribute_parent [name _eq mid] = ‛\nparent(⟪parentid⟫,«mid»).’
  Attribute_source [name _eq mid] = ‛\nsource(⟪parentid⟫,«mid»).’
  Attribute_target [name _eq mid] = ‛\ntarget(⟪parentid⟫,«mid»).’
  Attribute_style [_style _eq lq attr+ rq] = ‛«attr»’
  Attribute_other [name _eq s] = ‛\n"«name»"=«s»,’

  styleattr_edgelabel [name _eq s _semi] = ‛\n "edgeLabel":true,’
  styleattr_value [name _eq s _semi] = ‛\n "value":«s»,’
  styleattr_shape [name _eq s _semi] = ‛\n "shape":«s»,’
  styleattr_edge [name _eq s _semi] = ‛\n "edge":true,’
  styleattr_rhombus [name _semi] = ‛\n "shape":"rhombus",’
  styleattr_long [name _eq v _semi] = ‛’
  styleattr_short [name _semi] = ‛’

  number [d+ frac?] = ‛«d»«frac»’
  frac [_dot d+] = ‛.«d»’
  points [lb n* _comma* rb] = ‛’
  name [c cs*] = ‛«c»«cs»’
  stuff [x] = ‛’
  string [lq cs+ rq] = ‛"«cs»"’
  mappedid [lq cs+ rq] = ‛⎨mapid ‛«cs»’⎬’
  schar [c] = ‛«c»’

}